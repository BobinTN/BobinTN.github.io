{
  "version": 3,
  "sources": ["../../@arcgis/core/views/layers/StreamLayerView.js", "../../@arcgis/core/views/2d/layers/StreamLayerView2D.js"],
  "sourcesContent": ["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.28/esri/copyright.txt for details.\n*/\nimport{_ as s}from\"../../chunks/tslib.es6.js\";import{property as e}from\"../../core/accessorSupport/decorators/property.js\";import\"../../core/accessorSupport/ensureType.js\";import\"../../core/arrayUtils.js\";import\"../../core/has.js\";import{subclass as r}from\"../../core/accessorSupport/decorators/subclass.js\";import t from\"../../layers/support/FeatureFilter.js\";const o=o=>{let i=class extends o{resume(){this._isUserPaused=!1,this.suspended||this._doResume()}pause(){this._isUserPaused=!0,this.suspended||this._doPause()}constructor(...s){super(...s),this._isUserPaused=!1,this.filter=null}get connectionStatus(){return this._isUserPaused?\"paused\":this._streamConnectionStatus}_onSuspendedChange(s){s?this._doPause():this._isUserPaused||this._doResume()}};return s([e()],i.prototype,\"_isUserPaused\",void 0),s([e({readOnly:!0})],i.prototype,\"connectionStatus\",null),s([e({type:t})],i.prototype,\"filter\",void 0),i=s([r(\"esri.layers.mixins.StreamLayerView\")],i),i};export{o as default};\n", "/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.28/esri/copyright.txt for details.\n*/\nimport{_ as e}from\"../../../chunks/tslib.es6.js\";import t from\"../../../core/Error.js\";import{handlesGroup as r,makeHandle as s}from\"../../../core/handleUtils.js\";import{watch as i}from\"../../../core/reactiveUtils.js\";import{property as n}from\"../../../core/accessorSupport/decorators/property.js\";import\"../../../core/accessorSupport/ensureType.js\";import\"../../../core/arrayUtils.js\";import\"../../../core/has.js\";import{subclass as o}from\"../../../core/accessorSupport/decorators/subclass.js\";import a from\"../../../rest/support/FeatureSet.js\";import l from\"./FeatureLayerView2D.js\";import{toJSONGeometryType as p}from\"./support/util.js\";import c from\"../../layers/StreamLayerView.js\";function u(e,t){if(null==e&&null==t)return null;const r={};return null!=t&&(r.geometry=t.toJSON()),null!=e&&(r.where=e),r}let d=class extends(c(l)){constructor(){super(...arguments),this.pipelineConnectionStatus=\"disconnected\",this.pipelineErrorString=null,this._enabledEventTypes=new Set}initialize(){this.addHandles([i((()=>this.layer.customParameters),(e=>this._proxy.updateCustomParameters(e))),this.layer.on(\"send-message-to-socket\",(e=>this._proxy.sendMessageToSocket(e))),this.layer.on(\"send-message-to-client\",(e=>this._proxy.sendMessageToClient(e))),i((()=>this.layer.purgeOptions),(()=>this._update())),i((()=>this.suspended),this._onSuspendedChange.bind(this))],\"constructor\")}get connectionError(){return this.pipelineErrorString?new t(\"stream-controller\",this.pipelineErrorString):null}on(e,t){if(Array.isArray(e))return r(e.map((e=>this.on(e,t))));const i=[\"data-received\",\"message-received\"].includes(e);i&&(this._enabledEventTypes.add(e),this._proxy.enableEvent(e,!0));const n=super.on(e,t),o=this;return s((()=>{n.remove(),i&&(o._proxy.closed||o.hasEventListener(e)||o._proxy.enableEvent(e,!1))}))}queryLatestObservations(e,r){if(!(this.layer.timeInfo?.endField||this.layer.timeInfo?.startField||this.layer.timeInfo?.trackIdField))throw new t(\"streamlayer-no-timeField\",\"queryLatestObservation can only be used with services that define a TrackIdField\");return this._proxy.queryLatestObservations(this._cleanUpQuery(e),r).then((e=>{const t=a.fromJSON(e);return t.features.forEach((e=>{e.layer=this.layer,e.sourceLayer=this.layer})),t}))}detach(){super.detach(),this.pipelineConnectionStatus=\"disconnected\"}get _streamConnectionStatus(){return this.pipelineConnectionStatus}_doPause(){this._proxy?.pauseStream()}_doResume(){this._proxy?.resumeStream()}_createClientOptions(){return{...super._createClientOptions(),setProperty:e=>{this.set(e.propertyName,e.value)}}}_createTileRendererHash(e){const t=`${JSON.stringify(this.layer.purgeOptions)}.${JSON.stringify(u(this.layer.definitionExpression,this.layer.geometryDefinition))})`;return super._createTileRendererHash(e)+t}async _createServiceOptions(){const e=this.layer,{objectIdField:t}=e,r=e.fields.map((e=>e.toJSON())),s=p(e.geometryType),i=e.timeInfo?.toJSON()||null,n=e.spatialReference?e.spatialReference.toJSON():null;return{type:\"stream\",isPaused:this._isUserPaused,fields:r,fieldsIndex:this.layer.fieldsIndex.toJSON(),geometryType:s,objectIdField:t,timeInfo:i,source:this.layer.parsedUrl,serviceFilter:u(this.layer.definitionExpression,this.layer.geometryDefinition),purgeOptions:this.layer.purgeOptions.toJSON(),enabledEventTypes:Array.from(this._enabledEventTypes.values()),spatialReference:n,maxReconnectionAttempts:this.layer.maxReconnectionAttempts,maxReconnectionInterval:this.layer.maxReconnectionInterval,updateInterval:this.layer.updateInterval,customParameters:e.customParameters}}};e([n()],d.prototype,\"pipelineConnectionStatus\",void 0),e([n()],d.prototype,\"pipelineErrorString\",void 0),e([n({readOnly:!0})],d.prototype,\"connectionError\",null),e([n({readOnly:!0})],d.prototype,\"_streamConnectionStatus\",null),d=e([o(\"esri.views.2d.layers.StreamLayerView2D\")],d);const y=d;export{y as default};\n"],
  "mappings": "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",
  "names": ["o", "s", "d", "e", "t", "d", "o", "s", "y"]
}
